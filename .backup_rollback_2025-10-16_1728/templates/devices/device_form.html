{% extends "base.html" %}

{% block content %}
<div class="container" style="max-width: 820px;">
  <div class="card shadow-sm border-0">
    <div class="card-header bg-white border-0">
      <h5 class="m-0">
        {% if form.instance.pk %}编辑设备{% else %}新增设备{% endif %}
      </h5>
    </div>
    <div class="card-body">
      <form method="post" novalidate>
        {% csrf_token %}
        {% if form.non_field_errors %}
          <div class="alert alert-danger py-2">{{ form.non_field_errors }}</div>
        {% endif %}

        <div class="row g-3">
          <!-- 设备名称 -->
          <div class="col-md-6">
            <label class="form-label">设备名称</label>
            {{ form.name|add_class:"form-control" }}
            {% if form.name.errors %}<div class="text-danger small">{{ form.name.errors }}</div>{% endif %}
          </div>

          <!-- 设备类型 -->
          <div class="col-md-6">
            <label class="form-label">设备类型</label>
            {{ form.device_type|add_class:"form-select" }}
            {% if form.device_type.errors %}<div class="text-danger small">{{ form.device_type.errors }}</div>{% endif %}
          </div>

          <!-- 安装位置 -->
          <div class="col-md-6">
            <label class="form-label">安装位置</label>
            {{ form.location|add_class:"form-control" }}
            {% if form.location.errors %}<div class="text-danger small">{{ form.location.errors }}</div>{% endif %}
          </div>

          <!-- 状态 -->
          <div class="col-md-6">
            <label class="form-label">状态</label>
            {{ form.status|add_class:"form-select" }}
            {% if form.status.errors %}<div class="text-danger small">{{ form.status.errors }}</div>{% endif %}
          </div>

          <!-- 其它可能存在的字段（避免丢字段） -->
          {% for f in form %}
            {% if f.name not in "name,device_type,location,status" %}
              <div class="col-12">
                <label class="form-label">{{ f.label }}</label>
                {{ f|add_class:"form-control" }}
                {% if f.errors %}<div class="text-danger small">{{ f.errors }}</div>{% endif %}
              </div>
            {% endif %}
          {% endfor %}
        </div>

        <div class="d-flex justify-content-end gap-2 mt-4">
          <a href="{% url 'devices:list' %}" class="btn btn-outline-secondary">取消</a>
          <button type="submit" class="btn btn-primary">保存</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
  .form-label{ font-weight:600; }
</style>
{% endblock %}
